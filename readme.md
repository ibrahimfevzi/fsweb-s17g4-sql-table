# SQL Sorgu Alıştırmaları

Bu hafta SQL sorguları üzerine çalışıyorsunuz. Bugünkü alıştırmada sıfırdan bir veritabanı oluşturacak ve aşağıda istenenleri SQL sorgu olarak oluşturacaksınız.

# Proje Kurulumu

Projeyi forklayın ve clonlayın. Tamamladığınızda da pushlayın.
N

Add Index Add Column

## Görev 1: Kütüphane Bilgi Sistemi için Tablo Tasarımı

Bu veritabanı, bir okulun kütüphanesinden öğrencilerin aldıkları kitapların bilgisini barındıracak.
Aşağıda tablolar ve şemaları verilmiş.

[ ] Bu tabloların tasarımını online olarak veya bilgisayarınızda bir yazılım kullanarak dizayn ediniz. (örn: [drawsql.app](https://drawsql.app/)
[ ] Resim olarak proje dosyasına ekleyiniz.

-- Tablolar

`ogrenci` tablosu öğrencilerin listesini tutar.

| field | data type        | metadata                                      |
| :---- | :--------------- | :-------------------------------------------- | --- |
| id    | unsigned integer | primary key, auto-increments, generated by db |
| ad    | string           | required                                      | N   |

| soyad | string | required |
| dtarih | string | required |
| cinsiyet | string | required |
| sinif | string | required |
| puan | unsigned integer | required |

`islem` tablosu öğrencilerin kütüphaneden aldıkları kitapların bilgilerini tutar

| field      | data type        | metadata                                      |
| :--------- | :--------------- | :-------------------------------------------- |
| id         | unsigned integer | primary key, auto-increments, generated by db |
| ogrenci_id | unsigned integer | foreign key referencing ogrenci.id, required  |
| kitap_id   | unsigned integer | foreign key referencing kitap.id, required    |
| atarih     | string           | required                                      |
| vtarih     | string           | required                                      |

N

Add Index Add Column

`kitap` tablosu kütüphanedeki kitapların bilgisini tutar

| field       | data type        | metadata                                      |
| :---------- | :--------------- | :-------------------------------------------- |
| id          | unsigned integer | primary key, auto-increments, generated by db |
| ad          | string           | required                                      |
| sayfasayisi | unsigned integer | required                                      |
| puan        | unsigned integer | required                                      |
| yazar_id    | unsigned integer | foreign key referencing yazar.id, required    |
| tur_id      | unsigned integer | foreign key referencing tur.id, required      |

`yazar` tablosu kitapların yazarları bilgisini tutar

| field | data type        | metadata                                      |
| :---- | :--------------- | :-------------------------------------------- |
| id    | unsigned integer | primary key, auto-increments, generated by db |
| ad    | string           | required                                      |
| soyad | string           | required                                      |

`tur` tablosu kitapların türlerini tutar.

| field | data type        | metadata                                      |
| :---- | :--------------- | :-------------------------------------------- |
| id    | unsigned integer | primary key, auto-increments, generated by db |
| ad    | string           | required                                      |

### Görev 2: SQL İfadeleri

[ ] Görev 1'de tasarımını yaptığınız tabloları DB'de oluşturan komutları kutuphane_bilgi_sistemi.sql dosyasında oluşturunuz.

#### Görev 3:

[ ] veriler.sql içindeki hataları düzelterek, verileri veritabanınıza ekleyiniz.

##### Görev 4:

[ ] Aşağıda istenen değişiklikleri tablolarda yapacak SQL ifadeleri yazınız.

1- öğrenci tablosuna 'sehir' alanı ekleyiniz.
ALTER TABLE ogrenci
ADD sehir VARCHAR(255);

2- tablolarda veri olarak tarih geçen alanlarda veri tipini string yerine DateTime olarak ayarlayınız.

-- ogrenci tablosunda dtarih alanının veri tipini güncelleme
ALTER TABLE ogrenci
ALTER COLUMN dtarih TYPE TIMESTAMP USING dtarih::TIMESTAMP;

-- islem tablosunda atarih ve vtarih alanlarının veri tipini güncelleme
ALTER TABLE islem
ALTER COLUMN atarih TYPE TIMESTAMP USING atarih::TIMESTAMP;

ALTER TABLE islem
ALTER COLUMN vtarih TYPE TIMESTAMP USING vtarih::TIMESTAMP;

3- öğrenci tablosuna 'dogum_yeri' alanı ekleyiniz ve default değerini 'Türkiye' yapınız.
ALTER TABLE ogrenci
ADD dogum_yeri VARCHAR(255) DEFAULT 'Türkiye';

4- öğrenci tablosundan 'puan' alanını siliniz.

5- öğrenciler tablosundaki kiz öğrencileri alarak kiz_ogrenciler tablosu oluşturunuz.
CREATE TABLE kiz_ogrenciler AS
SELECT \* FROM ogrenci WHERE cinsiyet = 'K';

6- kiz_ogrenciler tablosunu siliniz.
DROP TABLE kiz_ogrenciler;

7- kiz_yurdu tablosu oluşturunuz(sadece 'ad' alanı olsun). 1 kayıt ekleyiniz.
öğrenci tablosundaki kız öğrencileri kullanarak kiz_yurdunda_kalanlar tablosu oluşturunuz

CREATE TABLE kiz_yurdu (
id SERIAL PRIMARY KEY,
ad VARCHAR(255) NOT NULL
);

INSERT INTO kiz_yurdu (ad) VALUES ('Örnek Kız Yurdu');

CREATE TABLE kiz_yurdunda_kalanlar AS
SELECT * FROM ogrenci WHERE cinsiyet = 'K';

8- kiz_ogrenciler tablosunun adını kogrenciler olarak değiştiriniz
//önce tabloyu oluştruyoruz
CREATE TABLE kiz_ogrenciler AS
SELECT * FROM ogrenci WHERE cinsiyet = 'K';

//sonra tabloyu yeniden adlandırıyoruz
ALTER TABLE kiz_ogrenciler
RENAME TO kogrenciler;

9- yazar tablosundaki 'ad' alanının adını 'name' olarak güncelleyiniz.

ALTER TABLE yazar
RENAME COLUMN ad TO name;

10- yazar tablosuna 'ulke' ve 'universite' alanları ekleyiniz 'ulke'nin default değeri 'Türkiye' olsun.

ALTER TABLE yazar
ADD ulke VARCHAR(255) DEFAULT 'Türkiye';

ALTER TABLE yazar
ADD universite VARCHAR(255);

11- tablo ilişkilerine 5'er tane örnek veriniz (1-1, 1-n, n-n)

1-1 İlişki Örneği:
Örnek olarak "kullanici" ve "profil" adında iki tablo düşünelim. Her bir kullanıcının yalnızca bir profilinin olmasını istiyoruz. Bu durumda "kullanici" tablosunda kullanıcılara ait bilgileri tutarız ve "profil" tablosunda da kullanıcılara ait profil bilgilerini saklarız. İki tablo arasında kullanıcı kimlik numarası (user_id) üzerinden 1-1 ilişki kurulur.

kullanici tablosu
+---------+----------+---------+
| user_id | username | email   |
+---------+----------+---------+
| 1       | ali      | ali@example.com |
| 2       | ayse     | ayse@example.com|
+---------+----------+---------+

profil tablosu
+---------+--------+-----+
| user_id | ad     | yas |
+---------+--------+-----+
| 1       | Ali    | 25  |
| 2       | Ayşe   | 30  |
+---------+--------+-----+

1-n İlişki Örneği:
Örnek olarak "kategori" ve "urun" adında iki tablo düşünelim. Her bir kategorinin birden fazla ürüne sahip olmasını istiyoruz. Bu durumda "kategori" tablosunda kategorilere ait bilgileri tutarız ve "urun" tablosunda da ürünlere ait bilgileri saklarız. İki tablo arasında kategori kimlik numarası (category_id) üzerinden 1-n ilişki kurulur.
kategori tablosu
+-------------+----------+
| category_id | kategori |
+-------------+----------+
| 1           | Elektronik  |
| 2           | Giyim       |
+-------------+----------+

urun tablosu
+---------+-----------------+-------------+
| urun_id | urun_adi        | category_id |
+---------+-----------------+-------------+
| 1       | Telefon         | 1           |
| 2       | Televizyon      | 1           |
| 3       | Gömlek          | 2           |
| 4       | Pantolon        | 2           |
+---------+-----------------+-------------+

n-n İlişki Örneği:
Örnek olarak "ogrenci" ve "ders" adında iki tablo düşünelim. Bir öğrencinin birden fazla dersi olabilir ve bir derste birden fazla öğrenci bulunabilir. Bu durumda "ogrenci" tablosunda öğrencilere ait bilgileri tutarız ve "ders" tablosunda da derslere ait bilgileri saklarız. İki tablo arasında bir "ogrenci_ders" adında ara tablo oluşturarak n-n ilişki kurulur.

ogrenci tablosu
+-----------+------------+
| ogrenci_id | ad         |
+-----------+------------+
| 1         | Ali        |
| 2         | Ayşe       |
| 3         | Mehmet     |
+-----------+------------+

ders tablosu
+---------+---------+
| ders_id | ders    |
+---------+---------+
| 1       | Matematik|
| 2       | Fizik    |
| 3       | Kimya    |
+---------+---------+

ogrenci_ders tablosu
+-----------+---------+
| ogrenci_id | ders_id |
+-----------+---------+
| 1         | 1       |
| 1         | 2       |
| 2         | 1       |
| 3         | 3       |
+-----------+---------+
Yukarıdaki örnekte "ogrenci" tablosunda her bir öğrenciye ait bilgiler tutulur, "ders" tablosunda da her bir derse ait bilgiler saklanır. "ogrenci_ders" tablosu ise öğrenci ve derslerin ilişkisini tutar. Her bir öğrenciye hangi derslerin ait olduğunu ve her bir derste hangi öğrencilerin olduğunu belirtir.